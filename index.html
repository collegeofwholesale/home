<!-- College of Wholesale Offer Calculator — FULL SINGLE FILE v3.0 -->
<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>College of Wholesale Offer Calculator</title>
<meta name="description" content="Beginner-friendly wholesale MAO calculator with a state-adjusted Repair Calculator and ARV tips." />
<style>
  :root{
    --bg:#0b0f1a; --card:#121829; --ink:#e6ebff; --muted:#9aa3b2;
    --accent:#6ea8ff; --accent-2:#8cffc7; --danger:#ff6b6b;
    --ok:#8bff99; --warn:#ffd06e; --line:#1e2740; --radius:18px;
  }
  *{box-sizing:border-box}
  html,body{margin:0;padding:0;background:var(--bg);color:var(--ink);font:16px/1.45 Inter,system-ui,Segoe UI,Roboto,Helvetica,Arial,sans-serif}
  a{color:var(--accent)}
  .wrap{max-width:1100px;margin:40px auto;padding:0 16px}
  h1{font-size:clamp(22px,3.6vw,36px);font-weight:800;letter-spacing:.2px;margin:0 0 6px}
  .subtitle{color:var(--muted);margin:0 0 22px}
  .tabs{display:flex;gap:8px;flex-wrap:wrap;margin:14px 0 20px}
  .tab-btn{border:1px solid var(--line);background:#0f1526;color:var(--ink);padding:10px 14px;border-radius:999px;cursor:pointer}
  .tab-btn.active{background:linear-gradient(135deg,var(--accent),#7dc0ff);color:#07122b;border-color:transparent}
  .grid{display:grid;gap:16px}
  @media(min-width:900px){.grid.two{grid-template-columns:1fr 1fr}}
  .card{background:linear-gradient(180deg,#121829 0%,#0f1424 100%);border:1px solid var(--line);border-radius:var(--radius);padding:18px;box-shadow:0 6px 24px rgba(0,0,0,.35)}
  .card h3{margin:0 0 10px;font-size:18px}
  .row{display:flex;gap:10px;align-items:center;margin:10px 0}
  .row.wrap{flex-wrap:wrap}
  label{min-width:170px;color:var(--muted)}
  input[type="number"],input[type="text"],select{
    width:100%;padding:10px 12px;border-radius:12px;border:1px solid var(--line);background:#0b1020;color:var(--ink);outline:none
  }
  input[type="checkbox"]{transform:scale(1.15)}
  .small{font-size:12px;color:var(--muted)}
  .btn{background:linear-gradient(135deg,var(--accent),#7dc0ff);border:none;color:#08122b;padding:10px 14px;border-radius:12px;font-weight:700;cursor:pointer}
  .btn.secondary{background:#0b1020;border:1px solid var(--line);color:var(--ink)}
  .btn.ghost{background:transparent;border:1px dashed var(--line);color:var(--muted)}
  .out{font-size:28px;font-weight:800;margin-top:8px}
  .pill{display:inline-block;padding:6px 10px;border-radius:999px;background:#0b1020;border:1px solid var(--line);color:var(--muted);font-size:12px;margin-right:6px}
  .footnote{color:var(--muted);font-size:12px}
  .hr{height:1px;background:linear-gradient(90deg,transparent,var(--line),transparent);margin:14px 0}
  .success{color:var(--ok)}
  .warn{color:var(--warn)}
  .danger{color:var(--danger)}
  .stack{display:flex;flex-direction:column;gap:8px}
  .right{margin-left:auto}
  .muted{color:var(--muted)}
  .kpi{display:grid;grid-template-columns:repeat(3,1fr);gap:10px}
  .kpi .card{padding:14px;text-align:center}
  .kpi .num{font-size:22px;font-weight:800}
  .tag{font-size:11px;padding:2px 8px;border-radius:999px;border:1px solid var(--line);color:var(--muted);display:inline-block}
  .sr{position:absolute;left:-9999px}
</style>
</head>
<body>
  <div class="wrap">
    <h1>College of Wholesale Offer Calculator</h1>
    <p class="subtitle">Beginner-friendly MAO + a state-adjusted Repair Calculator. Fast. Simple. CoW-approved.</p>

    <div class="tabs">
      <button class="tab-btn active" data-tab="offer">Offer Calculator</button>
      <button class="tab-btn" data-tab="repair">Repair Calculator</button>
      <button class="tab-btn" data-tab="help">Rules of Thumb & ARV Tips</button>
    </div>

    <!-- KPI quick glance -->
    <div class="kpi" aria-hidden="true">
      <div class="card">
        <div class="small">Discount Rule</div>
        <div class="num" id="kpi-discount">70%</div>
        <div class="small muted">Adjustable</div>
      </div>
      <div class="card">
        <div class="small">Your Fee (default)</div>
        <div class="num" id="kpi-fee">$10,000</div>
        <div class="small muted">Editable</div>
      </div>
      <div class="card">
        <div class="small">Closing Buffer</div>
        <div class="num" id="kpi-close">3% of ARV</div>
        <div class="small muted">Auto-calc</div>
      </div>
    </div>

    <!-- Offer Calculator -->
    <section id="offer" class="card" role="region" aria-labelledby="offer-h">
      <h3 id="offer-h">Offer Calculator (MAO)</h3>
      <div class="grid two">
        <div class="stack">
          <div class="row">
            <label for="arv">After-Repair Value (ARV)</label>
            <input type="number" id="arv" placeholder="e.g., 350000" min="0" step="1000">
          </div>
          <div class="row">
            <label for="repairs">Repairs (from Repair Calc)</label>
            <input type="number" id="repairs" placeholder="0" min="0" step="500">
            <button class="btn secondary right" id="pullRepairs" title="Pull latest repair total">Use Latest Repair Total</button>
          </div>
          <div class="row">
            <label for="discount">Buyer Discount %</label>
            <input type="number" id="discount" value="70" min="40" max="90" step="1">
          </div>
          <div class="row">
            <label for="fee">Your Assignment Fee ($)</label>
            <input type="number" id="fee" value="10000" min="0" step="500">
          </div>
          <div class="row">
            <label for="closePct">Closing/Holding Buffer % of ARV</label>
            <input type="number" id="closePct" value="3" min="0" max="10" step="0.5">
          </div>
          <div class="row">
            <button class="btn" id="calcOffer">Calculate MAO</button>
            <button class="btn ghost right" id="resetOffer">Reset</button>
          </div>
        </div>
        <div class="stack">
          <div class="pill">Simple 70% rule (editable)</div>
          <div class="pill">Auto subtract Repairs + Buffer + Your Fee</div>
          <div class="hr"></div>
          <div class="small">Max Allowable Offer (to seller):</div>
          <div class="out" id="mao">$0</div>
          <div class="small">Suggested first offer range:</div>
          <div class="out warn" id="range">$0 – $0</div>
          <div class="hr"></div>
          <div class="footnote">This is a quick screening tool for <strong>beginners</strong>. Actual buyers, markets, and exit strategies vary.</div>
        </div>
      </div>
    </section>

    <!-- Repair Calculator -->
    <section id="repair" class="card" role="region" aria-labelledby="repair-h" hidden>
      <h3 id="repair-h">Repair Calculator (State-Adjusted)</h3>

      <div class="grid two">
        <div class="stack">
          <div class="row wrap">
            <label for="addr">Property Address (optional)</label>
            <input type="text" id="addr" placeholder="123 Main St, Boca Raton, FL 33432">
            <button class="btn secondary" id="detectState">Detect State</button>
          </div>

          <div class="row">
            <label for="state">State</label>
            <select id="state"></select>
          </div>

          <div class="row">
            <label>Multiplier</label>
            <div id="multiplierView" class="pill">x1.00</div>
            <span class="small muted">Costs below auto-scale by state</span>
          </div>

          <div class="hr"></div>
          <div class="small muted">Select items that need work. (Preset averages; you can tweak quantities where shown.)</div>

          <div class="stack" id="lineItems"></div>

          <div class="row">
            <button class="btn" id="calcRepair">Calculate Repair Total</button>
            <button class="btn ghost right" id="resetRepair">Reset</button>
          </div>
        </div>

        <div class="stack">
          <div class="pill">Version B: Checkboxes + Preset Averages</div>
          <div class="hr"></div>

          <div class="small">Estimated Repairs:</div>
          <div class="out success" id="repairsOut">$0</div>

          <div class="small">Notes:</div>
          <ul class="small muted" id="notes">
            <li>Multipliers are rough market averages to keep this beginner-friendly.</li>
            <li>Use this total directly in the Offer Calculator.</li>
          </ul>

          <div class="row">
            <button class="btn secondary" id="sendToOffer">Send to Offer Calculator</button>
          </div>

          <div class="hr"></div>
          <div class="footnote">
            Tip: If the roof and HVAC are newer (&lt; 10 years), you can often uncheck those and save big.
          </div>
        </div>
      </div>
    </section>

    <!-- Help -->
    <section id="help" class="card" role="region" aria-labelledby="help-h" hidden>
      <h3 id="help-h">Rules of Thumb & How to Find ARV (fast)</h3>
      <div class="grid two">
        <div class="stack">
          <h4>Beginner Rules of Thumb</h4>
          <ul class="small">
            <li><strong>70% Rule (starting point):</strong> MAO ≈ (ARV × 0.70) − Repairs − Your Fee − Closing Buffer.</li>
            <li><strong>Closing/Holding Buffer:</strong> 2–4% of ARV for quick estimates (use 3% default).</li>
            <li><strong>Your Fee:</strong> Start at $10k. Raise in high-price or low-competition areas.</li>
            <li><strong>Offer Range:</strong> Open 5–10% under MAO to leave room to negotiate.</li>
          </ul>
        </div>
        <div class="stack">
          <h4>How to Find ARV (simple)</h4>
          <ol class="small">
            <li><strong>Pull comps</strong> within 0.5–1.0 miles, same bed/bath type, similar size (±15%), sold in last 3–6 months.</li>
            <li><strong>Match style</strong> (e.g., ranch vs. two-story), year built (±10–15 yrs), and lot size.</li>
            <li><strong>Use 3–5 best comps</strong> and average their sale price after small adjustments.</li>
            <li><strong>Double-check</strong> MLS/Zillow/Redfin photos to ensure reno level matches your target ARV.</li>
          </ol>
        </div>
      </div>
    </section>

    <div class="hr"></div>
    <p class="footnote">© <span id="year"></span> College of Wholesale • For education only. Not legal, tax, or financial advice.</p>
  </div>

<script>
/* =========================
   UTILITIES & CONSTANTS
   ========================= */
const $ = (q)=>document.querySelector(q);
const $$ = (q)=>document.querySelectorAll(q);
const fmt = (n)=> isNaN(n) ? "$0" : n.toLocaleString(undefined,{style:'currency',currency:'USD',maximumFractionDigits:0});
const clamp = (v,min,max)=> Math.max(min,Math.min(max,v));

/* State cost multipliers (simple approximations to keep newbie-friendly).
   1.00 = baseline. Higher = more expensive market; Lower = cheaper. */
const STATE_MULT = {
  AL:0.92, AK:1.30, AZ:1.02, AR:0.90, CA:1.20, CO:1.08, CT:1.12, DE:1.04, FL:1.08,
  GA:0.96, HI:1.40, ID:0.98, IL:1.05, IN:0.93, IA:0.90, KS:0.91, KY:0.90, LA:0.94,
  ME:1.04, MD:1.10, MA:1.18, MI:0.95, MN:1.02, MS:0.88, MO:0.92, MT:1.00, NE:0.92,
  NV:1.02, NH:1.06, NJ:1.15, NM:0.96, NY:1.18, NC:0.98, ND:0.98, OH:0.93, OK:0.91,
  OR:1.08, PA:1.04, RI:1.10, SC:0.97, SD:0.94, TN:0.96, TX:0.94, UT:1.02, VT:1.06,
  VA:1.05, WA:1.12, WV:0.90, WI:0.95, WY:0.94, DC:1.22
};

const STATE_NAMES = {
  AL:"Alabama", AK:"Alaska", AZ:"Arizona", AR:"Arkansas", CA:"California", CO:"Colorado", CT:"Connecticut",
  DE:"Delaware", FL:"Florida", GA:"Georgia", HI:"Hawaii", ID:"Idaho", IL:"Illinois", IN:"Indiana",
  IA:"Iowa", KS:"Kansas", KY:"Kentucky", LA:"Louisiana", ME:"Maine", MD:"Maryland", MA:"Massachusetts",
  MI:"Michigan", MN:"Minnesota", MS:"Mississippi", MO:"Missouri", MT:"Montana", NE:"Nebraska", NV:"Nevada",
  NH:"New Hampshire", NJ:"New Jersey", NM:"New Mexico", NY:"New York", NC:"North Carolina", ND:"North Dakota",
  OH:"Ohio", OK:"Oklahoma", OR:"Oregon", PA:"Pennsylvania", RI:"Rhode Island", SC:"South Carolina",
  SD:"South Dakota", TN:"Tennessee", TX:"Texas", UT:"Utah", VT:"Vermont", VA:"Virginia", WA:"Washington",
  WV:"West Virginia", WI:"Wisconsin", WY:"Wyoming", DC:"District of Columbia"
};

/* Version B line items with simple preset averages (baseline; state multiplier applies). */
const LINE_ITEMS = [
  { id:"paint_in",   label:"Interior Paint",                base:3500, qty:false },
  { id:"paint_out",  label:"Exterior Paint",                base:3200, qty:false },
  { id:"floor",      label:"Flooring (whole house)",        base:6000, qty:false },
  { id:"roof",       label:"Roof Replacement",              base:9500, qty:false },
  { id:"kitchen",    label:"Kitchen Refresh",               base:8000, qty:true,  qtyLabel:"# Kitchens", min:1, val:1 },
  { id:"bath",       label:"Bathroom Refresh",              base:3500, qty:true,  qtyLabel:"# Bathrooms", min:1, val:1 },
  { id:"hvac",       label:"HVAC (replace/major)",          base:6500, qty:false },
  { id:"windows",    label:"Windows (whole house)",         base:5500, qty:false },
  { id:"elect",      label:"Electrical (repairs/update)",   base:2500, qty:false },
  { id:"plumb",      label:"Plumbing (repairs)",            base:2200, qty:false },
  { id:"land",       label:"Landscaping/Exterior clean-up", base:1200, qty:false },
  { id:"misc",       label:"Misc / Contingency",            base:2000, qty:false }
];

/* ==============
   BUILD UI
   ============== */
function buildStateDropdown(){
  const sel = $("#state");
  sel.innerHTML = "";
  Object.keys(STATE_NAMES).forEach(ab=>{
    const o = document.createElement("option");
    o.value = ab; o.textContent = `${STATE_NAMES[ab]} (${ab})`;
    sel.appendChild(o);
  });
  sel.value = "FL"; // default for your market
  updateMultiplierPill();
}
function updateMultiplierPill(){
  const abbr = $("#state").value;
  const mult = STATE_MULT[abbr] ?? 1.00;
  $("#multiplierView").textContent = `x${mult.toFixed(2)}`;
}
function buildLineItems(){
  const host = $("#lineItems");
  host.innerHTML = "";
  LINE_ITEMS.forEach(it=>{
    const card = document.createElement("div");
    card.className = "card";
    card.style.padding = "12px";
    const row1 = document.createElement("div");
    row1.className = "row";
    const lb = document.createElement("label");
    lb.textContent = it.label;
    lb.setAttribute("for", it.id);
    const cb = document.createElement("input");
    cb.type = "checkbox"; cb.id = it.id; cb.dataset.base = it.base;
    cb.addEventListener("change", ()=> {
      const qwrap = card.querySelector(".qtywrap");
      if(qwrap) qwrap.hidden = !cb.checked;
    });
    row1.append(lb, cb);

    const row2 = document.createElement("div");
    row2.className = "row";
    const base = document.createElement("div");
    base.className = "small";
    base.textContent = `Baseline: ${fmt(it.base)}`;
    row2.append(base);

    card.append(row1,row2);

    if(it.qty){
      const qwrap = document.createElement("div");
      qwrap.className = "row qtywrap";
      qwrap.hidden = true;
      const qlb = document.createElement("label");
      qlb.textContent = it.qtyLabel;
      const qin = document.createElement("input");
      qin.type = "number"; qin.min = it.min ?? 1; qin.step = 1; qin.value = it.val ?? 1;
      qin.id = it.id + "_qty";
      qwrap.append(qlb,qin);
      card.append(qwrap);
    }
    host.append(card);
  });
}

/* Try to detect state from address input (very basic, no API). */
function detectStateFromAddress(){
  const txt = ($("#addr").value||"").toUpperCase();
  // Look for two-letter state codes bounded by word breaks OR full names
  const abbrs = Object.keys(STATE_NAMES);
  for(const ab of abbrs){
    const re = new RegExp(`\\b${ab}\\b`);
    if(re.test(txt)){ $("#state").value = ab; updateMultiplierPill(); return ab; }
  }
  // Try full names
  for(const [ab,name] of Object.entries(STATE_NAMES)){
    const re = new RegExp(`\\b${name.toUpperCase()}\\b`);
    if(re.test(txt)){ $("#state").value = ab; updateMultiplierPill(); return ab; }
  }
  alert("Couldn’t detect a state. Please choose it manually.");
  return null;
}

/* =========================
   OFFER CALC (simple 70% rule)
   ========================= */
function calcMAO(){
  const arv = +($("#arv").value||0);
  const repairs = +($("#repairs").value||0);
  const discountPct = clamp(+($("#discount").value||70), 40, 90);
  const fee = +($("#fee").value||0);
  const closePct = clamp(+($("#closePct").value||3), 0, 10);

  // KPI mirror
  $("#kpi-discount").textContent = `${discountPct}%`;
  $("#kpi-fee").textContent = fmt(fee);
  $("#kpi-close").textContent = `${closePct}% of ARV`;

  const buyerNet = arv * (discountPct/100);
  const closingBuffer = arv * (closePct/100);
  const mao = Math.max(0, buyerNet - repairs - closingBuffer - fee);

  $("#mao").textContent = fmt(mao);
  const low = Math.max(0, Math.round(mao * 0.90));
  const high = Math.max(0, Math.round(mao));
  $("#range").textContent = `${fmt(low)} – ${fmt(high)}`;
}

/* =========================
   REPAIR CALC (Version B)
   ========================= */
function calcRepairs(){
  const abbr = $("#state").value;
  const mult = STATE_MULT[abbr] ?? 1.00;
  let total = 0;
  let chosen = [];

  LINE_ITEMS.forEach(it=>{
    const cb = $("#"+it.id);
    if(cb && cb.checked){
      let cost = (+cb.dataset.base||0);
      if(it.qty){
        const q = +($("#"+it.id+"_qty").value||1);
        cost *= Math.max(1, Math.floor(q));
      }
      const adj = cost * mult;
      total += adj;
      chosen.push(`${it.label}: ${fmt(adj)}`);
    }
  });

  $("#repairsOut").textContent = fmt(total);
  const notes = $("#notes");
  notes.innerHTML = "";
  if(chosen.length){
    chosen.forEach(line=>{
      const li=document.createElement("li");
      li.className="small";
      li.textContent=line;
      notes.append(li);
    });
  }else{
    const li=document.createElement("li");
    li.className="small muted";
    li.textContent="No items selected yet.";
    notes.append(li);
  }
  return total;
}

/* =========================
   TABS & WIRING
   ========================= */
function switchTab(id){
  ["offer","repair","help"].forEach(sec=>{
    const el = $("#"+sec);
    const btn = document.querySelector(`.tab-btn[data-tab="${sec}"]`);
    if(sec===id){ el.hidden=false; btn.classList.add("active"); }
    else{ el.hidden=true; btn.classList.remove("active"); }
  });
}

document.addEventListener("DOMContentLoaded",()=>{
  $("#year").textContent = new Date().getFullYear();

  // Tabs
  $$(".tab-btn").forEach(b=>{
    b.addEventListener("click",()=>switchTab(b.dataset.tab));
  });

  // Build Repair UI
  buildStateDropdown();
  buildLineItems();

  // Offer
  $("#calcOffer").addEventListener("click", calcMAO);
  $("#resetOffer").addEventListener("click", ()=>{
    ["arv","repairs","discount","fee","closePct"].forEach(id=>$( "#"+id ).value = "");
    $("#discount").value = 70; $("#fee").value = 10000; $("#closePct").value = 3;
    $("#mao").textContent = "$0"; $("#range").textContent = "$0 – $0";
    $("#kpi-discount").textContent = "70%";
    $("#kpi-fee").textContent = "$10,000";
    $("#kpi-close").textContent = "3% of ARV";
  });

  // Repair
  $("#state").addEventListener("change", updateMultiplierPill);
  $("#detectState").addEventListener("click", detectStateFromAddress);
  $("#calcRepair").addEventListener("click", calcRepairs);
  $("#resetRepair").addEventListener("click", ()=>{
    LINE_ITEMS.forEach(it=>{
      const cb=$("#"+it.id); if(cb){ cb.checked=false; }
      if(it.qty){ const q=$("#"+it.id+"_qty"); if(q){ q.value = it.val ?? 1; } }
    });
    $("#repairsOut").textContent = "$0";
    $("#notes").innerHTML = '<li class="small muted">No items selected yet.</li>';
  });

  // Bridge: Repair -> Offer
  $("#sendToOffer").addEventListener("click", ()=>{
    const t = calcRepairs();
    $("#repairs").value = Math.round(t);
    switchTab("offer");
    window.scrollTo({top:0,behavior:"smooth"});
  });

  // Also allow Offer to pull latest Repair
  $("#pullRepairs").addEventListener("click", ()=>{
    const t = calcRepairs();
    $("#repairs").value = Math.round(t);
  });
});
</script>
</body>
</html>
