<!-- College of Wholesale ‚Äî Full Single-File Site + Offer/Repair Calculators (v4.0) -->
<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>College of Wholesale ‚Äî Offer Calculator & Training</title>
<meta name="description" content="College of Wholesale: training, tools, and community for new wholesalers. Includes a beginner-friendly Offer Calculator and state-adjusted Repair Calculator." />
<style>
  :root{
    --bg:#0b0f1a; --card:#121829; --ink:#e6ebff; --muted:#9aa3b2;
    --accent:#6ea8ff; --accent-2:#8cffc7; --danger:#ff6b6b;
    --ok:#8bff99; --warn:#ffd06e; --line:#1e2740; --radius:18px;
    --ink-d:#08122b;
  }
  *{box-sizing:border-box}
  html,body{margin:0;padding:0;background:var(--bg);color:var(--ink);font:16px/1.45 Inter,system-ui,Segoe UI,Roboto,Helvetica,Arial,sans-serif}
  a{color:var(--accent);text-decoration:none}
  .wrap{max-width:1100px;margin:0 auto;padding:0 16px}
  /* NAV */
  .nav{position:sticky;top:0;z-index:50;background:rgba(11,15,26,.8);backdrop-filter:blur(8px);border-bottom:1px solid var(--line)}
  .navin{display:flex;align-items:center;gap:14px;height:64px}
  .brand{font-weight:900;letter-spacing:.2px}
  .brand span{background:linear-gradient(135deg,var(--accent),#7dc0ff);-webkit-background-clip:text;background-clip:text;color:transparent}
  .spacer{flex:1}
  .nav a{padding:8px 10px;border-radius:10px}
  .nav a.active{background:linear-gradient(135deg,var(--accent),#7dc0ff);color:var(--ink-d)}
  .cta{background:linear-gradient(135deg,var(--accent-2),#b3ffd9);color:#073a28;padding:8px 12px;border-radius:12px;font-weight:800}
  /* HERO */
  .hero{padding:72px 0;background:
    radial-gradient(1200px 400px at 50% -50%, rgba(110,168,255,.22), transparent 70%);}
  .hero h1{font-size:clamp(28px,4.2vw,48px);margin:0 0 12px}
  .hero p{color:var(--muted);margin:0 0 18px}
  .hero .btn{background:linear-gradient(135deg,var(--accent),#7dc0ff);color:var(--ink-d);border:none;padding:12px 16px;border-radius:12px;font-weight:800;cursor:pointer}
  .chips{display:flex;gap:8px;flex-wrap:wrap;margin-top:10px}
  .chip{font-size:12px;color:var(--muted);border:1px solid var(--line);padding:6px 10px;border-radius:999px}
  /* SECTIONS */
  section{padding:56px 0;border-top:1px solid var(--line)}
  h2{font-size:clamp(22px,3vw,32px);margin:0 0 8px}
  .sub{color:var(--muted);margin:0 0 22px}
  .grid{display:grid;gap:16px}
  @media(min-width:900px){.grid.two{grid-template-columns:1fr 1fr}}
  .card{background:linear-gradient(180deg,#121829 0%,#0f1424 100%);border:1px solid var(--line);border-radius:18px;padding:18px;box-shadow:0 6px 24px rgba(0,0,0,.35)}
  .row{display:flex;gap:10px;align-items:center;margin:10px 0}
  .row.wrap{flex-wrap:wrap}
  label{min-width:170px;color:var(--muted)}
  input[type="number"],input[type="text"],select{width:100%;padding:10px 12px;border-radius:12px;border:1px solid var(--line);background:#0b1020;color:var(--ink);outline:none}
  input[type="checkbox"]{transform:scale(1.15)}
  .btn{background:linear-gradient(135deg,var(--accent),#7dc0ff);border:none;color:var(--ink-d);padding:10px 14px;border-radius:12px;font-weight:700;cursor:pointer}
  .btn.secondary{background:#0b1020;border:1px solid var(--line);color:var(--ink)}
  .btn.ghost{background:transparent;border:1px dashed var(--line);color:var(--muted)}
  .pill{display:inline-block;padding:6px 10px;border-radius:999px;background:#0b1020;border:1px solid var(--line);color:var(--muted);font-size:12px;margin-right:6px}
  .small{font-size:12px;color:var(--muted)}
  .out{font-size:28px;font-weight:800;margin-top:8px}
  .kpis{display:grid;grid-template-columns:repeat(3,1fr);gap:10px}
  .kpis .card{text-align:center;padding:14px}
  .kpis .num{font-size:22px;font-weight:800}
  .hr{height:1px;background:linear-gradient(90deg,transparent,var(--line),transparent);margin:14px 0}
  .stack{display:flex;flex-direction:column;gap:8px}
  .right{margin-left:auto}
  .muted{color:var(--muted)}
  .faq dt{font-weight:800;margin-top:12px}
  .faq dd{margin:6px 0 0 0;color:var(--muted)}
  footer{padding:28px 0;border-top:1px solid var(--line);color:var(--muted);font-size:13px}
  .hide{display:none}
</style>
</head>
<body>

<!-- ===== TOP NAV ===== -->
<div class="nav">
  <div class="wrap navin">
    <div class="brand">College of <span>Wholesale</span></div>
    <div class="spacer"></div>
    <a href="#home" data-page="home" class="navlink active">Home</a>
    <a href="#about" data-page="about" class="navlink">About</a>
    <a href="#calc" data-page="calc" class="navlink">Calculator</a>
    <a href="#resources" data-page="resources" class="navlink">Resources</a>
    <a href="#contact" data-page="contact" class="navlink">Contact</a>
    <a href="#calc" class="cta">Open Calculator</a>
  </div>
</div>

<!-- ===== PAGES ===== -->
<main>

  <!-- HOME -->
  <section id="home" class="page">
    <div class="wrap hero">
      <h1>Learn wholesaling the simple way.<br/>Use the tools. Get the reps. Close the deal.</h1>
      <p>College of Wholesale gives beginners a clear path: daily actions, beginner-friendly calculators, scripts, and a community that helps you win your first contract.</p>
      <div class="chips">
        <span class="chip">‚úÖ Beginner-Friendly</span>
        <span class="chip">üìû Cold Calling Scripts</span>
        <span class="chip">üßÆ Offer & Repair Calculator</span>
        <span class="chip">üìà KPI Templates</span>
      </div>
      <div style="margin-top:18px;display:flex;gap:10px;flex-wrap:wrap">
        <a class="btn" href="#calc">Try the Calculator</a>
        <a class="btn secondary" href="#resources">See Training Resources</a>
      </div>
    </div>
    <div class="wrap">
      <div class="grid two">
        <div class="card">
          <h3>What you‚Äôll learn</h3>
          <ul class="small">
            <li>How to find motivated sellers (probate, code violations, tax liens, pre-foreclosure, & more)</li>
            <li>How to estimate repairs with simple presets (no contractor needed)</li>
            <li>How to make offers using the 70% rule and protect your fee</li>
            <li>How to follow up like a pro and move deals to closing</li>
          </ul>
        </div>
        <div class="card">
          <h3>Fast start checklist</h3>
          <ol class="small">
            <li>Pick a market & pull a small niche list (500‚Äì1,000 leads)</li>
            <li>Practice the cold call script 10√ó out loud</li>
            <li>Use our Repair Calc presets for each call</li>
            <li>Plug numbers into the Offer Calculator & make the offer</li>
            <li>Follow up using your CRM tags (1w / 1m / 3m)</li>
          </ol>
        </div>
      </div>
    </div>
  </section>

  <!-- ABOUT -->
  <section id="about" class="page hide">
    <div class="wrap">
      <h2>About College of Wholesale</h2>
      <p class="sub">Founded by Arya Saliany, College of Wholesale (CoW) helps new wholesalers master the fundamentals through systems, scripts, and reps‚Äînot theory.</p>
      <div class="grid two">
        <div class="card">
          <h3>Our approach</h3>
          <ul class="small">
            <li>Simple tools you‚Äôll actually use on calls</li>
            <li>Clear SOPs for list pulling, tagging, and follow-up</li>
            <li>Daily actions & accountability inside the community</li>
          </ul>
        </div>
        <div class="card">
          <h3>Who it‚Äôs for</h3>
          <ul class="small">
            <li>Beginners who want their first assignment check</li>
            <li>Solo hustlers or student interns learning the ropes</li>
            <li>Anyone who needs a repeatable system to scale</li>
          </ul>
        </div>
      </div>

      <h3 style="margin-top:20px">What members say</h3>
      <div class="grid two">
        <div class="card small">‚ÄúThe repair presets made talking numbers 10√ó easier on my first calls.‚Äù</div>
        <div class="card small">‚ÄúOffer Calculator = instant confidence. I finally knew what to say.‚Äù</div>
      </div>
    </div>
  </section>

  <!-- CALCULATOR (Offer + Repair + Tips Tabs) -->
  <section id="calc" class="page hide">
    <div class="wrap">
      <h2>College of Wholesale Offer Calculator</h2>
      <p class="sub">Beginner-friendly MAO + a state-adjusted Repair Calculator. Fast. Simple. CoW-approved.</p>

      <!-- KPI quick glance -->
      <div class="kpis" aria-hidden="true">
        <div class="card">
          <div class="small">Discount Rule</div>
          <div class="num" id="kpi-discount">70%</div>
          <div class="small muted">Adjustable</div>
        </div>
        <div class="card">
          <div class="small">Your Fee (default)</div>
          <div class="num" id="kpi-fee">$10,000</div>
          <div class="small muted">Editable</div>
        </div>
        <div class="card">
          <div class="small">Closing Buffer</div>
          <div class="num" id="kpi-close">3% of ARV</div>
          <div class="small muted">Auto-calc</div>
        </div>
      </div>

      <div class="card" style="margin-top:16px">
        <div class="row" style="gap:8px;flex-wrap:wrap">
          <button class="btn secondary tabBtn active" data-tab="offer">Offer Calculator</button>
          <button class="btn secondary tabBtn" data-tab="repair">Repair Calculator</button>
          <button class="btn secondary tabBtn" data-tab="help">Rules of Thumb & ARV Tips</button>
        </div>
        <div class="hr"></div>

        <!-- Offer -->
        <section id="tab-offer">
          <div class="grid two">
            <div class="stack">
              <div class="row"><label for="arv">After-Repair Value (ARV)</label><input type="number" id="arv" placeholder="e.g., 350000" min="0" step="1000"></div>
              <div class="row"><label for="repairs">Repairs (from Repair Calc)</label><input type="number" id="repairs" placeholder="0" min="0" step="500"><button class="btn secondary right" id="pullRepairs">Use Latest Repair Total</button></div>
              <div class="row"><label for="discount">Buyer Discount %</label><input type="number" id="discount" value="70" min="40" max="90" step="1"></div>
              <div class="row"><label for="fee">Your Assignment Fee ($)</label><input type="number" id="fee" value="10000" min="0" step="500"></div>
              <div class="row"><label for="closePct">Closing/Holding Buffer % of ARV</label><input type="number" id="closePct" value="3" min="0" max="10" step="0.5"></div>
              <div class="row"><button class="btn" id="calcOffer">Calculate MAO</button><button class="btn ghost right" id="resetOffer">Reset</button></div>
            </div>
            <div class="stack">
              <div class="pill">Simple 70% rule (editable)</div>
              <div class="pill">Auto subtract Repairs + Buffer + Your Fee</div>
              <div class="hr"></div>
              <div class="small">Max Allowable Offer (to seller):</div>
              <div class="out" id="mao">$0</div>
              <div class="small">Suggested first offer range:</div>
              <div class="out" id="range">$0 ‚Äì $0</div>
              <div class="hr"></div>
              <div class="small">Heads-up: quick screening tool for beginners. Actual buyers & exits vary.</div>
            </div>
          </div>
        </section>

        <!-- Repair -->
        <section id="tab-repair" class="hide">
          <div class="grid two">
            <div class="stack">
              <div class="row wrap">
                <label for="addr">Property Address (optional)</label>
                <input type="text" id="addr" placeholder="123 Main St, Boca Raton, FL 33432">
                <button class="btn secondary" id="detectState">Detect State</button>
              </div>
              <div class="row"><label for="state">State</label><select id="state"></select></div>
              <div class="row"><label>Multiplier</label><div id="multiplierView" class="pill">x1.00</div><span class="small muted">Costs auto-scale by state</span></div>
              <div class="hr"></div>
              <div class="small muted">Check items that need work. Preset averages (quantities where shown).</div>
              <div class="stack" id="lineItems"></div>
              <div class="row"><button class="btn" id="calcRepair">Calculate Repair Total</button><button class="btn ghost right" id="resetRepair">Reset</button></div>
            </div>
            <div class="stack">
              <div class="pill">Version B: Checkboxes + Presets</div>
              <div class="hr"></div>
              <div class="small">Estimated Repairs:</div><div class="out" id="repairsOut">$0</div>
              <div class="small">Notes:</div>
              <ul class="small muted" id="notes"><li>Multipliers are rough market averages to keep this beginner-friendly.</li><li>Send total straight into the Offer Calculator.</li></ul>
              <div class="row"><button class="btn secondary" id="sendToOffer">Send to Offer Calculator</button></div>
              <div class="hr"></div>
              <div class="small">Tip: If roof/HVAC &lt; 10 years, you can often uncheck those and save big.</div>
            </div>
          </div>
        </section>

        <!-- Help -->
        <section id="tab-help" class="hide">
          <div class="grid two">
            <div class="stack">
              <h4>Beginner Rules of Thumb</h4>
              <ul class="small">
                <li><strong>70% Rule:</strong> MAO ‚âà (ARV √ó 0.70) ‚àí Repairs ‚àí Your Fee ‚àí Closing Buffer.</li>
                <li><strong>Closing/Holding Buffer:</strong> 2‚Äì4% of ARV (use 3% default).</li>
                <li><strong>Your Fee:</strong> Start at $10k. Raise in high-price or low-competition areas.</li>
                <li><strong>Offer Range:</strong> Open 5‚Äì10% under MAO to leave room to negotiate.</li>
              </ul>
            </div>
            <div class="stack">
              <h4>How to Find ARV (simple)</h4>
              <ol class="small">
                <li><strong>Pull comps</strong> within 0.5‚Äì1.0 miles, same bed/bath, ¬±15% size, sold in 3‚Äì6 months.</li>
                <li><strong>Match style</strong> (ranch vs. two-story), year built (¬±10‚Äì15 yrs), lot size.</li>
                <li><strong>Use 3‚Äì5 best comps</strong> and average their price (after small adjustments).</li>
                <li><strong>Verify photos</strong> so your ARV matches reno quality.</li>
              </ol>
            </div>
          </div>
        </section>

      </div>
    </div>
  </section>

  <!-- RESOURCES -->
  <section id="resources" class="page hide">
    <div class="wrap">
      <h2>Free Training Resources</h2>
      <p class="sub">Grab these starter assets and get to work.</p>
      <div class="grid two">
        <div class="card">
          <h3>Cold Call Opener (script)</h3>
          <pre class="small">‚ÄúHey, is this {FirstName}? My name‚Äôs {YourName}. I‚Äôm buying a place nearby and wondered if you‚Äôd consider an offer on {Address} if the price made sense?‚Äù</pre>
          <div class="small muted">Follow ups: ‚ÄúTotally fair‚Äîon a scale 1‚Äì10 how open are you?‚Äù ‚Üí Ask condition ‚Üí Use Repair presets ‚Üí Calculate MAO.</div>
        </div>
        <div class="card">
          <h3>Lead Tagging (simple)</h3>
          <ul class="small">
            <li>Hot ‚Äî follow up tomorrow</li>
            <li>Warm ‚Äî 1 week</li>
            <li>Nurture ‚Äî 1 month</li>
            <li>Long ‚Äî 3 months</li>
          </ul>
        </div>
        <div class="card">
          <h3>Beginner KPIs</h3>
          <ul class="small">
            <li>Calls/day: 100</li>
            <li>Contacts/day: 15‚Äì20</li>
            <li>Offers/week: 5+</li>
            <li>Contracts/month: 1 (early), 2‚Äì3 (consistent)</li>
          </ul>
        </div>
        <div class="card">
          <h3>Deal Types to Target</h3>
          <ul class="small">
            <li>Probate &amp; code violations</li>
            <li>Tax lien + tired landlords</li>
            <li>Pre-foreclosure (be ethical!)</li>
          </ul>
        </div>
      </div>
    </div>
  </section>

  <!-- CONTACT -->
  <section id="contact" class="page hide">
    <div class="wrap">
      <h2>Contact & Join</h2>
      <p class="sub">Questions, collabs, or ready to join the community?</p>
      <div class="grid two">
        <div class="card">
          <h3>DM on Discord</h3>
          <p class="small">Shoot Arya a DM with your market and goal for the week.</p>
          <a class="btn" href="#" onclick="alert('Replace this with your Discord invite or DM link.');return false;">Open Discord</a>
        </div>
        <div class="card">
          <h3>Email</h3>
          <p class="small">aaarya3455@gmail.com</p>
          <a class="btn secondary" href="mailto:aaarya3455@gmail.com">Email Arya</a>
        </div>
      </div>

      <h3 style="margin-top:22px">FAQ</h3>
      <dl class="faq">
        <dt>Is the calculator accurate?</dt>
        <dd>It‚Äôs a beginner screening tool to get you making offers fast. Always confirm with buyers/contractors.</dd>
        <dt>Can I share this page?</dt>
        <dd>Yes‚Äîsend them the URL. It‚Äôs a single page app; everything‚Äôs built in.</dd>
      </dl>
    </div>
  </section>

</main>

<footer>
  <div class="wrap">¬© <span id="year"></span> College of Wholesale ‚Ä¢ For education only. Not legal, tax, or financial advice.</div>
</footer>

<!-- ===== SCRIPTS ===== -->
<script>
/* ---------- Utilities ---------- */
const $ = (q)=>document.querySelector(q);
const $$ = (q)=>document.querySelectorAll(q);
const fmt = (n)=> isNaN(n) ? "$0" : n.toLocaleString(undefined,{style:'currency',currency:'USD',maximumFractionDigits:0});
const clamp=(v,min,max)=>Math.max(min,Math.min(max,v));

/* ---------- Simple Router (hash-based) ---------- */
const pages = ["home","about","calc","resources","contact"];
function showPage(id){
  pages.forEach(p=>{
    const el = $("#"+p);
    const link = document.querySelector(`.nav a[data-page="${p}"]`);
    if(p===id){ el.classList.remove("hide"); link?.classList.add("active"); }
    else{ el.classList.add("hide"); link?.classList.remove("active"); }
  });
  // Jump to top for page switch
  window.scrollTo({top:0,behavior:"instant"});
}
function route(){
  const h = (location.hash||"#home").replace("#","");
  showPage(pages.includes(h)?h:"home");
}
window.addEventListener("hashchange",route);
document.addEventListener("DOMContentLoaded",route);

/* ---------- Calculator Data ---------- */
// State multipliers (simple approximations)
const STATE_MULT = {
  AL:0.92, AK:1.30, AZ:1.02, AR:0.90, CA:1.20, CO:1.08, CT:1.12, DE:1.04, FL:1.08,
  GA:0.96, HI:1.40, ID:0.98, IL:1.05, IN:0.93, IA:0.90, KS:0.91, KY:0.90, LA:0.94,
  ME:1.04, MD:1.10, MA:1.18, MI:0.95, MN:1.02, MS:0.88, MO:0.92, MT:1.00, NE:0.92,
  NV:1.02, NH:1.06, NJ:1.15, NM:0.96, NY:1.18, NC:0.98, ND:0.98, OH:0.93, OK:0.91,
  OR:1.08, PA:1.04, RI:1.10, SC:0.97, SD:0.94, TN:0.96, TX:0.94, UT:1.02, VT:1.06,
  VA:1.05, WA:1.12, WV:0.90, WI:0.95, WY:0.94, DC:1.22
};
const STATE_NAMES = {
  AL:"Alabama", AK:"Alaska", AZ:"Arizona", AR:"Arkansas", CA:"California", CO:"Colorado", CT:"Connecticut",
  DE:"Delaware", FL:"Florida", GA:"Georgia", HI:"Hawaii", ID:"Idaho", IL:"Illinois", IN:"Indiana",
  IA:"Iowa", KS:"Kansas", KY:"Kentucky", LA:"Louisiana", ME:"Maine", MD:"Maryland", MA:"Massachusetts",
  MI:"Michigan", MN:"Minnesota", MS:"Mississippi", MO:"Missouri", MT:"Montana", NE:"Nebraska", NV:"Nevada",
  NH:"New Hampshire", NJ:"New Jersey", NM:"New Mexico", NY:"New York", NC:"North Carolina", ND:"North Dakota",
  OH:"Ohio", OK:"Oklahoma", OR:"Oregon", PA:"Pennsylvania", RI:"Rhode Island", SC:"South Carolina",
  SD:"South Dakota", TN:"Tennessee", TX:"Texas", UT:"Utah", VT:"Vermont", VA:"Virginia", WA:"Washington",
  WV:"West Virginia", WI:"Wisconsin", WY:"Wyoming", DC:"District of Columbia"
};
// Repair line items (Version B)
const LINE_ITEMS = [
  { id:"paint_in",   label:"Interior Paint",                base:3500, qty:false },
  { id:"paint_out",  label:"Exterior Paint",                base:3200, qty:false },
  { id:"floor",      label:"Flooring (whole house)",        base:6000, qty:false },
  { id:"roof",       label:"Roof Replacement",              base:9500, qty:false },
  { id:"kitchen",    label:"Kitchen Refresh",               base:8000, qty:true,  qtyLabel:"# Kitchens", min:1, val:1 },
  { id:"bath",       label:"Bathroom Refresh",              base:3500, qty:true,  qtyLabel:"# Bathrooms", min:1, val:1 },
  { id:"hvac",       label:"HVAC (replace/major)",          base:6500, qty:false },
  { id:"windows",    label:"Windows (whole house)",         base:5500, qty:false },
  { id:"elect",      label:"Electrical (repairs/update)",   base:2500, qty:false },
  { id:"plumb",      label:"Plumbing (repairs)",            base:2200, qty:false },
  { id:"land",       label:"Landscaping/Exterior clean-up", base:1200, qty:false },
  { id:"misc",       label:"Misc / Contingency",            base:2000, qty:false }
];

/* ---------- Build Repair UI ---------- */
function buildStateDropdown(){
  const sel = $("#state");
  sel.innerHTML = "";
  Object.keys(STATE_NAMES).forEach(ab=>{
    const o = document.createElement("option");
    o.value = ab; o.textContent = `${STATE_NAMES[ab]} (${ab})`;
    sel.appendChild(o);
  });
  sel.value = "FL"; // default for your market
  updateMultiplierPill();
}
function updateMultiplierPill(){
  const abbr = $("#state").value;
  const mult = STATE_MULT[abbr] ?? 1.00;
  $("#multiplierView").textContent = `x${mult.toFixed(2)}`;
}
function buildLineItems(){
  const host = $("#lineItems");
  host.innerHTML = "";
  LINE_ITEMS.forEach(it=>{
    const card = document.createElement("div");
    card.className = "card";
    card.style.padding = "12px";
    const row1 = document.createElement("div");
    row1.className = "row";
    const lb = document.createElement("label");
    lb.textContent = it.label;
    lb.setAttribute("for", it.id);
    const cb = document.createElement("input");
    cb.type = "checkbox"; cb.id = it.id; cb.dataset.base = it.base;
    cb.addEventListener("change", ()=> {
      const qwrap = card.querySelector(".qtywrap");
      if(qwrap) qwrap.hidden = !cb.checked;
    });
    row1.append(lb, cb);

    const row2 = document.createElement("div");
    row2.className = "row";
    const base = document.createElement("div");
    base.className = "small";
    base.textContent = `Baseline: ${fmt(it.base)}`;
    row2.append(base);

    card.append(row1,row2);

    if(it.qty){
      const qwrap = document.createElement("div");
      qwrap.className = "row qtywrap";
      qwrap.hidden = true;
      const qlb = document.createElement("label");
      qlb.textContent = it.qtyLabel;
      const qin = document.createElement("input");
      qin.type = "number"; qin.min = it.min ?? 1; qin.step = 1; qin.value = it.val ?? 1;
      qin.id = it.id + "_qty";
      qwrap.append(qlb,qin);
      card.append(qwrap);
    }
    host.append(card);
  });
}
/* Detect state from address (basic, no API) */
function detectStateFromAddress(){
  const txt = ($("#addr").value||"").toUpperCase();
  // two-letter codes
  for(const ab of Object.keys(STATE_NAMES)){
    const re = new RegExp(`\\b${ab}\\b`);
    if(re.test(txt)){ $("#state").value = ab; updateMultiplierPill(); return ab; }
  }
  // full names
  for(const [ab,name] of Object.entries(STATE_NAMES)){
    const re = new RegExp(`\\b${name.toUpperCase()}\\b`);
    if(re.test(txt)){ $("#state").value = ab; updateMultiplierPill(); return ab; }
  }
  alert("Couldn‚Äôt detect a state. Choose it manually.");
  return null;
}

/* ---------- Offer Calc ---------- */
function calcMAO(){
  const arv = +($("#arv").value||0);
  const repairs = +($("#repairs").value||0);
  const discountPct = clamp(+($("#discount").value||70), 40, 90);
  const fee = +($("#fee").value||0);
  const closePct = clamp(+($("#closePct").value||3), 0, 10);

  $("#kpi-discount").textContent = `${discountPct}%`;
  $("#kpi-fee").textContent = fmt(fee);
  $("#kpi-close").textContent = `${closePct}% of ARV`;

  const buyerNet = arv * (discountPct/100);
  const closingBuffer = arv * (closePct/100);
  const mao = Math.max(0, buyerNet - repairs - closingBuffer - fee);

  $("#mao").textContent = fmt(mao);
  const low = Math.max(0, Math.round(mao * 0.90));
  const high = Math.max(0, Math.round(mao));
  $("#range").textContent = `${fmt(low)} ‚Äì ${fmt(high)}`;
}

/* ---------- Repair Calc ---------- */
function calcRepairs(){
  const abbr = $("#state").value;
  const mult = STATE_MULT[abbr] ?? 1.00;
  let total = 0;
  let chosen = [];

  LINE_ITEMS.forEach(it=>{
    const cb = $("#"+it.id);
    if(cb && cb.checked){
      let cost = (+cb.dataset.base||0);
      if(it.qty){
        const q = +($("#"+it.id+"_qty").value||1);
        cost *= Math.max(1, Math.floor(q));
      }
      const adj = cost * mult;
      total += adj;
      chosen.push(`${it.label}: ${fmt(adj)}`);
    }
  });

  $("#repairsOut").textContent = fmt(total);
  const notes = $("#notes");
  notes.innerHTML = "";
  if(chosen.length){
    chosen.forEach(line=>{
      const li=document.createElement("li");
      li.className="small";
      li.textContent=line;
      notes.append(li);
    });
  }else{
    const li=document.createElement("li");
    li.className="small muted";
    li.textContent="No items selected yet.";
    notes.append(li);
  }
  return total;
}

/* ---------- Tab (inside Calculator card) ---------- */
function switchCalcTab(id){
  ["offer","repair","help"].forEach(t=>{
    const sec = $("#tab-"+t);
    const btn = document.querySelector(`.tabBtn[data-tab="${t}"]`);
    if(t===id){ sec.classList.remove("hide"); btn.classList.add("active"); }
    else{ sec.classList.add("hide"); btn.classList.remove("active"); }
  });
}

/* ---------- Init ---------- */
document.addEventListener("DOMContentLoaded",()=>{
  $("#year").textContent = new Date().getFullYear();

  // Nav links
  $$(".navlink").forEach(a=>{
    a.addEventListener("click", e=>{
      $$(".navlink").forEach(l=>l.classList.remove("active"));
      a.classList.add("active");
    });
  });

  // Build Repair UI
  buildStateDropdown();
  buildLineItems();

  // Calculator inner-tabs
  $$(".tabBtn").forEach(b=> b.addEventListener("click", ()=> switchCalcTab(b.dataset.tab) ));

  // Offer wiring
  $("#calcOffer").addEventListener("click", calcMAO);
  $("#resetOffer").addEventListener("click", ()=>{
    ["arv","repairs","discount","fee","closePct"].forEach(id=>$( "#"+id ).value = "");
    $("#discount").value = 70; $("#fee").value = 10000; $("#closePct").value = 3;
    $("#mao").textContent = "$0"; $("#range").textContent = "$0 ‚Äì $0";
    $("#kpi-discount").textContent = "70%";
    $("#kpi-fee").textContent = "$10,000";
    $("#kpi-close").textContent = "3% of ARV";
  });

  // Repair wiring
  $("#state").addEventListener("change", updateMultiplierPill);
  $("#detectState").addEventListener("click", detectStateFromAddress);
  $("#calcRepair").addEventListener("click", calcRepairs);
  $("#resetRepair").addEventListener("click", ()=>{
    LINE_ITEMS.forEach(it=>{
      const cb=$("#"+it.id); if(cb){ cb.checked=false; }
      if(it.qty){ const q=$("#"+it.id+"_qty"); if(q){ q.value = it.val ?? 1; } }
    });
    $("#repairsOut").textContent = "$0";
    $("#notes").innerHTML = '<li class="small muted">No items selected yet.</li>';
  });

  // Bridge Repair -> Offer
  $("#sendToOffer").addEventListener("click", ()=>{
    const t = calcRepairs();
    $("#repairs").value = Math.round(t);
    // switch to offer tab
    switchCalcTab("offer");
    // jump to top of calculator
    document.querySelector('#calc').scrollIntoView({behavior:'smooth',block:'start'});
  });

  // Also allow Offer to pull latest Repair
  $("#pullRepairs").addEventListener("click", ()=>{
    const t = calcRepairs();
    $("#repairs").value = Math.round(t);
  });
});
</script>

</body>
</html>
